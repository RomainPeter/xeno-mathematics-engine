{
  "id": "k-no-secrets",
  "title": "No Hardcoded Secrets",
  "description": "Prevent hardcoded secrets in source code",
  "category": "security",
  "severity": "high",
  "source_incident": "s2_secret_injection",
  "obligations": ["k-no-secrets", "k-secret-scanning", "k-env-vars-only"],
  "test_cases": [
    {
      "name": "no_hardcoded_secrets",
      "description": "No secrets should be hardcoded in source",
      "expected": "fail"
    },
    {
      "name": "env_vars_used",
      "description": "Secrets must use environment variables",
      "expected": "pass"
    },
    {
      "name": "secret_scan_clean",
      "description": "Secret scanning must pass",
      "expected": "fail"
    }
  ],
  "implementation": {
    "type": "opa",
    "file": "policy/no-secrets.rego",
    "command": "opa eval -d policy/no-secrets.rego -i input.json data"
  }
}
